console.log(`
WARNING!!! ÐšÐžÐ“Ð”Ð Ð¢Ð« ÐÐÐ–ÐœÐ•Ð¨Ð¬ ÐÐ ÐšÐÐžÐŸÐšÐ£ START - Ð—ÐÐ˜Ð“Ð ÐÐ•Ð¢ ÐœÐ£Ð—Ð«ÐšÐ WARNING!!!
\n
ÐŸÑ€Ð¸Ð²ÐµÑ‚, Ð¼Ð¾Ð¹ Ð ÐµÐ²ÑŒÑŽÐµÑ€ :)
Ð•ÑÐ»Ð¸ Ñƒ Ñ‚ÐµÐ±Ñ ÐµÑÑ‚ÑŒ ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¸, Ð»ÑŽÐ±Ñ‹Ðµ ÑÐ¾Ð²ÐµÑ‚Ñ‹ Ð¸Ð»Ð¸ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¿Ð¾ Ð¼Ð¾ÐµÐ¹ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ, Ð¿Ð¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð° Ð½Ð°Ð¿Ð¸ÑˆÐ¸ Ð¼Ð½Ðµ RS Ð´Ð¸ÑÐºÐ¾Ñ€Ð´Ðµ: Ania @marblehands Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð·Ð° Ñ‚Ð²Ð¾ÑŽ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÑƒ!
\n
ÐœÐ¾Ñ Ð¾Ñ†ÐµÐ½ÐºÐ° Ð¿Ð¾ÑÐ»Ðµ ÑÐ°Ð¼Ð¾Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸: 70 Ð±Ð°Ð»Ð»Ð¾Ð²
\n
1. Ð’Ñ‘Ñ€ÑÑ‚ÐºÐ° +10
    * âœ… Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½ Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ Ð¸Ð³Ñ€Ñ‹ +5
    * âœ… Ð”ÐµÑÐºÑ‚Ð¾Ð¿Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸ÑŽ Ð¾Ñ‚ 1024px Ð¸ Ð²Ñ‹ÑˆÐµ. ÐœÐ¾Ð±Ð¸Ð»ÑŒÐ½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¾Ñ‚ 600px Ð´Ð¾ 1024px. Ð ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ñ‹ Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ðµ ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ñ‹.
    * âœ… Ð’ Ñ„ÑƒÑ‚ÐµÑ€Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ ÐµÑÑ‚ÑŒ ÑÑÑ‹Ð»ÐºÐ° Ð½Ð° Ð³Ð¸Ñ‚Ñ…Ð°Ð± Ð°Ð²Ñ‚Ð¾Ñ€Ð° Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ, Ð³Ð¾Ð´ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ,Â Ð»Ð¾Ð³Ð¾Ñ‚Ð¸Ð¿ ÐºÑƒÑ€ÑÐ°Â ÑÐ¾Â ÑÑÑ‹Ð»ÐºÐ¾Ð¹ Ð½Ð° ÐºÑƒÑ€ÑÂ +5
2. âœ… Ð›Ð¾Ð³Ð¸ÐºÐ° Ð¸Ð³Ñ€Ñ‹. Ð¥Ð¾Ð´Ñ‹, Ð¿ÐµÑ€ÐµÐ¼ÐµÑ‰ÐµÐ½Ð¸Ñ Ñ„Ð¸Ð³ÑƒÑ€, Ð´Ñ€ÑƒÐ³Ð¸Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð¿Ð¾Ð´Ñ‡Ð¸Ð½ÑÑŽÑ‚ÑÑ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ñ‘Ð½Ð½Ñ‹Ð¼ ÑÐ²Ð¾Ð¹ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¼ Ð¸Ð³Ñ€Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°Ð¼: Ð·Ð¼ÐµÐ¹ÐºÐ° ÐºÑƒÑˆÐ°ÐµÑ‚ ÐµÐ´Ñƒ Ð¸ Ñ€Ð°ÑÑ‚ÐµÑ‚, Ð½ÐµÐ»ÑŒÐ·Ñ ÐºÑƒÑˆÐ°Ñ‚ÑŒ ÑÐ°Ð¼Ð¾Ð³Ð¾ ÑÐµÐ±Ñ Ð¸ Ð²Ñ‹Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒ Ð·Ð° Ð¿Ñ€ÐµÐ´ÐµÐ»Ñ‹ Ð¿Ð¾Ð»Ñ +10
3. âœ… Ð ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ðµ Ð¸Ð³Ñ€Ñ‹ Ð¿Ñ€Ð¸ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ð¸ Ð¸Ð³Ñ€Ð¾Ð²Ð¾Ð¹ Ñ†ÐµÐ»Ð¸ +10
Ð˜Ð³Ñ€Ð° Ð·Ð°Ð²ÐµÑ€ÑˆÐ°ÐµÑ‚ÑÑ ÐµÑÐ»Ð¸ Ð·Ð¼ÐµÐ¹ÐºÐ° Ð²Ñ‹Ñ…Ð¾Ð´Ð¸Ñ‚ Ð·Ð° Ð¿Ñ€ÐµÐ´ÐµÐ»Ñ‹ Ð¸Ð³Ñ€Ð¾Ð²Ð¾Ð³Ð¾ Ð¿Ð¾Ð»Ñ Ð¸Ð»Ð¸ ÐµÑÑ‚ ÑÐ°Ð¼Ñƒ ÑÐµÐ±Ñ. Ð¦ÐµÐ»ÑŒ Ð¸Ð³Ñ€Ñ‹ Ð½Ð°Ð±Ñ€Ð°Ñ‚ÑŒ ÐºÐ°Ðº Ð¼Ð¾Ð¶Ð½Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð¾Ñ‡ÐºÐ¾Ð².
4. âœ… ÐŸÐ¾ Ð¾ÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸ÑŽ Ð¸Ð³Ñ€Ñ‹ Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ÑÑ ÐµÑ‘ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: Ð½Ð°Ð±Ñ€Ð°Ð½Ð½Ð¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¾Ñ‡ÐºÐ¾Ð². +10
5. âœ… Ð’ Ð¾ÐºÐ½Ðµ Results Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ÑÑ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° Top Results. Ð­Ñ‚Ð° Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ ÑÐ¾Ð±Ð¾Ð¹ 10 Ð»ÑƒÑ‡ÑˆÐ¸Ñ… Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð² Ð·Ð° Ð²ÑÐµ Ð²Ñ€ÐµÐ¼Ñ. Ð”ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ñ‹ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð² Ð½Ðµ Ð²Ñ‹Ð²Ð¾Ð´ÑÑ‚ÑÑ, Ñ‚Ð°Ðº ÐºÐ°Ðº Ð¸Ð³Ñ€Ñ‹ Ð½Ðµ Ð¿ÐµÑ€ÑÐ¾Ð½Ð¸Ñ„Ð¸Ñ†Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹. Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ 0 Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ÑÑ Ð¾Ð´Ð¸Ð½ Ñ€Ð°Ð·, ÐµÑÐ»Ð¸ Ð½ÐµÑ‚ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð² Ð»ÑƒÑ‡ÑˆÐµ. Ð’ÑÐµ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð²ÑÐµÑ… Ð¸Ð³Ñ€Ñ‹ Ñ…Ñ€Ð°Ð½ÑÑ‚ÑÑ Ð² localstorage Ð² Ð¼Ð°ÑÑÐ¸Ð²Ðµ AllGamesresults +10
6. âœ… ÐÐ½Ð¸Ð¼Ð°Ñ†Ð¸Ð¸ Ð¸Ð»Ð¸ Ð·Ð²ÑƒÐºÐ¸, Ð¸Ð»Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð¸Ð³Ñ€Ñ‹. Ð‘Ð°Ð»Ð»Ñ‹ Ð½Ð°Ñ‡Ð¸ÑÐ»ÑÑŽÑ‚ÑÑ Ð·Ð° Ð»ÑŽÐ±Ð¾Ð¹ Ð¸Ð· Ð¿ÐµÑ€ÐµÑ‡Ð¸ÑÐ»ÐµÐ½Ð½Ñ‹Ñ… Ð¿ÑƒÐ½ÐºÑ‚Ð¾Ð². Ð’ Ð¸Ð³Ñ€Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ Ñ„Ð¾Ð½Ð¾Ð²Ñ‹Ð¹ Ð·Ð²ÑƒÐºÐ¾Ð²Ð¾Ð¹ Ñ€ÑÐ´ Ð¸ Ð½ÐµÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð·Ð²ÑƒÐºÐ¾Ð²Ñ‹Ðµ ÑÑ„Ñ„ÐµÐºÑ‚Ñ‹ Ð¸Ð³Ñ€Ð¾Ð²Ñ‹Ñ… ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹. Ð—Ð²ÑƒÐº Ð¼Ð¾Ð¶Ð½Ð¾ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ Ð¿Ð¾ Ð¸ÐºÐ¾Ð½ÐºÐµ Ð¼ÑŒÑŽÑ‚Ð°. Ð¢Ð°ÐºÐ¶Ðµ ÐµÑÑ‚ÑŒ Ð½ÐµÐ±Ð¾Ð»ÑŒÑˆÐ°Ñ Ð°Ð½Ð¸Ð¼Ð°Ñ†Ð¸Ñ Ð¾Ð±Ð»Ð°ÐºÐ¾Ð², ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÑ‚ÑÑ Ð¿Ð¾ÑÐ»Ðµ ÑÑ‚Ð°Ñ€Ñ‚Ð° Ð¸Ð³Ñ€Ñ‹. +10
7. ÐžÑ‡ÐµÐ½ÑŒ Ð²Ñ‹ÑÐ¾ÐºÐ¾Ðµ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð¸/Ð¸Ð»Ð¸ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð½Ðµ Ð¿Ñ€ÐµÐ´ÑƒÑÐ¼Ð¾Ñ‚Ñ€ÐµÐ½Ð½Ñ‹Ð¹ Ð² Ð·Ð°Ð´Ð°Ð½Ð¸Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð», ÑƒÐ»ÑƒÑ‡ÑˆÐ°ÑŽÑ‰Ð¸Ð¹ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ +10
    * Ð²Ñ‹ÑÐ¾ÐºÐ¾Ðµ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð¿Ñ€ÐµÐ´Ð¿Ð¾Ð»Ð°Ð³Ð°ÐµÑ‚ ÑÐ¾Ð±ÑÑ‚Ð²ÐµÐ½Ð½Ð¾Ðµ Ð¾Ñ€Ð¸Ð³Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ðµ Ñ€Ð°Ð²Ð½Ð¾Ðµ Ð¸Ð»Ð¸ Ð¾Ñ‚Ð»Ð¸Ñ‡Ð°ÑŽÑ‰ÐµÐµÑÑ Ð² Ð»ÑƒÑ‡ÑˆÑƒÑŽ ÑÑ‚Ð¾Ñ€Ð¾Ð½Ñƒ Ð¿Ð¾ ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸ÑŽ Ñ Ð´ÐµÐ¼Ð¾
Ð’ Ð¸Ð³Ñ€Ðµ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½ ÐºÐ°ÑÑ‚Ð¾Ð¼Ð½Ñ‹Ð¹ Ð´Ð¸Ð·Ð°Ð¹Ð½. ÐÐµÐ¼Ð½Ð¾Ð³Ð¾ Ð¼Ñ€Ð°Ñ‡Ð½Ð¾Ð²Ð°Ñ‚Ñ‹Ð¹, Ð½Ð¾ ÑÑ‚Ð¾ Ð² Ñ‡ÐµÑÑ‚ÑŒ Ð¿Ñ€Ð¸Ð±Ð»Ð¸Ð¶Ð°ÑŽÑ‰ÐµÐ³Ð¾ÑÑ Ð¥ÑÐ»Ð»ÑƒÐ¸Ð½Ð°. ðŸ‘»
`);

//game controls and modals
const startBtn = document.getElementById('start')
const gameOverModal = document.querySelector('.game-over-modal')

//mobile controls
const leftBtn = document.querySelector('.arrow-left')
const rightBtn = document.querySelector('.arrow-right')
const upBtn = document.querySelector('.arrow-up')
const downBtn = document.querySelector('.arrow-down')

//audio related variables
const audio = new Audio()
const playlist = ['assets/audio/spooky-halloween.mp3', 'assets/audio/spooky-scenes.mp3', 'assets/audio/let-the-mystery-unfold.mp3', 'assets/audio/kim-lightyear-lullaby.mp3']
let currentSong = 0
audio.src = playlist[currentSong]
audio.volume = 0.2

//start the game
startBtn.addEventListener('click', () =>{
  const firstScreen = document.querySelector('.first-screen-modal')
  const scoreInfo = document.querySelector('.wrapper-score')
  firstScreen.classList.add('hide')
  scoreInfo.classList.remove('hide')
  audio.play()
  animatePage ()

  leftBtn.addEventListener('click', () => {
      setDirection(directions.LEFT)
  })

  rightBtn.addEventListener('click', () => {
      setDirection(directions.RIGHT)
  })

  upBtn.addEventListener('click', () => {
      setDirection(directions.UP)
  })

  downBtn.addEventListener('click', () => {
      setDirection(directions.DOWN)
  })
})

//canvas
const canvas = document.getElementById('board-canvas')
const context = canvas.getContext('2d')
const boardWrapper = document.querySelector('.board-game')

//variables with colors
const boardColour = '#0A1A1B'
const snakeHeadColour = '#AEF020'
const snakeBodyColour = '#2A686D'
const foodColour = '#00FFC2'


//canvas size
let boardWidth = updateCanvasWidth()
let boardHeight = boardWidth
let moduleSize = 30
// let ratio = boardWidth / moduleSize
let ratio = 20

//variables for game
const loopFrequency = 1000/8
let gameUpdate
let game = false

//variable for score
const currentScoreNum = document.querySelector('.current-score-number')
const highScoreNum = document.querySelector('.high-score-number')


//get canvas size
updateCanvasWidth()
window.addEventListener('resize', updateCanvasWidth)

//update canvas width
function updateCanvasWidth() {
  var boardSize = boardWrapper.getBoundingClientRect().width
  canvas.style.width = boardSize + 'px'
  canvas.style.height = boardSize + 'px'

  const screenRatio = window.devicePixelRatio
  canvas.width = boardSize * screenRatio
  canvas.height = boardSize * screenRatio

  context.scale(screenRatio, screenRatio)

  return canvas.width
}

//variables for snake
let snake = [
  {x : 8, y : 10}, //head
  {x : 7, y : 10}, //body
  {x : 6, y : 10}, //tail
]
const defaultSnakeLength = snake.length

//food
let food = generateRandomFood ()

//generate random coordinates for food
function generateRandomFood () {
  // let boardWidth = updateCanvasWidth()
  if (boardWidth > 600) {
    boardWidth /= 2
  }
  // console.log(boardWidth)
  let ratio = boardWidth / moduleSize
  // console.log(ratio)
  let food = {
    x : Math.floor(Math.random() * ratio),
    y : Math.floor(Math.random() * ratio),
  }

  while (snake.some((segment) => (segment.x === food.x && segment.y === food.y) || (food.x >= 20 && food.y >= 20))) {
    food = {
      x : Math.floor(Math.random() * ratio),
      y : Math.floor(Math.random() * ratio),
    }
  }
  // console.log(snake)
  // console.log(food)
  return food
}

function createFood () {
  drawModule(food.x, food.y, foodColour)
  // console.log('success')
}

//variables for direction
let currentDirection = ''
let directionsSequence = [];
const directions = {
  RIGHT: 'ArrowRight',
  LEFT: 'ArrowLeft',
  DOWN: 'ArrowDown',
  UP: 'ArrowUp'
}

document.addEventListener('keyup', setDirection)
function setDirection (event) {
  const nextDirection = event.key || event
  // console.log(nextDirection)
  let previousDirection = currentDirection

  if (
  (nextDirection === directions.LEFT &&
    previousDirection !== directions.RIGHT) ||
  (nextDirection === directions.RIGHT &&
    previousDirection !== directions.LEFT) ||
  (nextDirection === directions.DOWN &&
    previousDirection !== directions.UP) ||
  (nextDirection === directions.UP &&
    previousDirection !== directions.DOWN)
  ) {
    if(!game) {
      game = true
      gameUpdate = setInterval(infiniteLoad, loopFrequency)
    }
    directionsSequence.push(nextDirection)
    // console.log(directionsSequence)
  }
}


//create Game Board
function createBoardGame () {
  context.fillStyle = boardColour
  context.fillRect(0, 0, boardWidth, boardHeight)
  for (let k = 29; k < 570; k += 30) {
        for (let i = 29; i < 570; i += 30) {
          context.fillStyle = '#1F2E2B'
          context.fillRect(k, i, 2, 2)
        }
      }
}

//create one square module on canvas
function drawModule (x, y, color) {
  context.fillStyle = color
  context.fillRect(
    x * moduleSize,
    y * moduleSize,
    moduleSize,
    moduleSize)

  // context.strokeStyle = boardColour
  // context.strokeRect(
  //   x * moduleSize,
  //   y * moduleSize,
  //   moduleSize,
  //   moduleSize
  // )
}

//create snake on canvas
function createSnake () {
  snake.forEach((segment, index) => {
    const colour = index === 0 ? snakeHeadColour : snakeBodyColour
    drawModule(segment.x, segment.y, colour)
  })
}

//movement of snake
function runSnake () {
  if(!game) return;
  //get head coordinates
  const headPosition = { ...snake[0] }
  // console.log(headPosition)

  if (directionsSequence.length) {
    currentDirection = directionsSequence.shift()
  }

  //change head position
  switch(currentDirection) {
    case directions.RIGHT:
      headPosition.x += 1;
      break;
    case directions.LEFT:
      headPosition.x -= 1;
      break;
    case directions.UP:
      headPosition.y -= 1;
      break;
    case directions.DOWN:
      headPosition.y += 1;
      break;
  }

if (isFoodEaten()) {
  food = generateRandomFood ()
} else {
  //remove last element in snake array
  snake.pop()
}

//add new head to new snake
snake.unshift(headPosition)
}

function isFoodEaten () {
  const head = snake[0]
  return head.x === food.x && head.y === food.y
}

//score update
let currentScore = 0
let highScore = highScoreCount ()
function updateScore () {
  currentScore = snake.length - defaultSnakeLength
  currentScoreNum.innerHTML = `/${currentScore}`
}

infiniteLoad ()

//updating the board infinitely
function infiniteLoad () {
  // console.log('test')

  createBoardGame()
  createSnake()
  createFood ()
  runSnake()
  updateScore ()
  highScoreCount ()

  if (goOut() || eatSelf()) {
    clearInterval(gameUpdate)
    setTimeout(endOfGame, 800)
    // console.log('test')
    // console.log(ratio)
  }
}

function goOut () {
  const head = snake[0]
  // console.log(head.y, ratio)
  console.log(ratio)
  return (head.x >= ratio || head.x < 0 || head.y >= ratio || head.y < 0)
}

function eatSelf () {
  const newSnake = [ ...snake ]
  const head = newSnake.shift()
  // console.log(newSnake)
  return (
    newSnake.some((segment) => (head.x === segment.x && head.y === segment.y))
    )
}

function endOfGame() {
  game = false
  gameOverModal.classList.remove('hide')
  context.clearRect(0, 0, canvas.width, canvas.height)

  const totalScoreNum = document.querySelector('.total-score-number')
  totalScoreNum.innerHTML =`/${currentScore}`

  // const clouds = document.querySelector('.clouds')
  // clouds.style.animation = ''

  saveResults ()
  highScoreCount ()
}

function saveResults () {
  let allGamesResults = JSON.parse(localStorage.getItem('allGamesResults')) || []
  allGamesResults.push(currentScore)
  localStorage.setItem('allGamesResults', JSON.stringify(allGamesResults))
}

function highScoreCount () {
  let allGamesResults = JSON.parse(localStorage.getItem('allGamesResults')) || []
  if (allGamesResults.length) {
    let highScore = allGamesResults.reduce((accum, score) => {
      return ((score > accum) ? score : accum)
    }, [allGamesResults[0]])
    highScoreNum.innerHTML = `/${highScore}`
    return highScore
  } else {
    let highScore = 0
    highScoreNum.innerHTML = `/${highScore}`
    return highScore
  }
}

// restart the game
const restartBtn = document.getElementById('restart')
restartBtn.addEventListener('click', () => {
  console.log('click')
  startNewGame()
})

function startNewGame () {
  snake = [
    {x : 8, y : 10},
    {x : 7, y : 10},
    {x : 6, y : 10},
  ]

  currentDirection = ''
  directionsSequence = [];

  game = false

  gameOverModal.classList.add('hide')

  infiniteLoad ()
}

//open results table
const gameResultsModal = document.querySelector('.top-score-modal')
const resultsBtn = document.getElementById('results')
resultsBtn.addEventListener('click', () => {
  gameOverModal.classList.add('hide')
  gameResultsModal.classList.remove('hide')
  updateScoreTable ()
})

//close results
const closeBtn = document.getElementById('close')
closeBtn.addEventListener('click', () => {
  gameOverModal.classList.remove('hide')
  gameResultsModal.classList.add('hide')
})

//update score table
function updateScoreTable () {
  const allGamesResults = JSON.parse(localStorage.getItem('allGamesResults')) || []
  allGamesResults.sort((a,b)=> b - a)
  console.log(allGamesResults)
  const allGamesResultsFiltered = [ ...new Set(allGamesResults)]
  console.log(allGamesResultsFiltered)
  const bestScores = allGamesResultsFiltered.slice(0, 10)
  console.log(bestScores)
  const scoreItems = document.querySelectorAll('.score-item')
  scoreItems.forEach((item, index) => {
    if (bestScores[index] !== undefined) {
      const scoreNum = document.createElement('span')
      scoreNum.className = 'score-text'
      item.classList.add('active')
      item.innerHTML = ''
      scoreNum.textContent = bestScores[index]
      item.appendChild(scoreNum)
    }
  })
}

function animatePage () {
  const clouds = document.querySelector('.clouds')
  clouds.style.animation = '100s float infinite linear'

  const batLeft = document.querySelector('.bat-left')
  const batRight = document.querySelector('.bat-right')

  batLeft.style.animation = 'move1 10s infinite alternate'
  batRight.style.animation = 'move2 10s infinite alternate'
}


//audio related functions

audio.addEventListener('ended', playNext)

function playNext () {
  currentSong = (currentSong + 1) % playlist.length
  audio.src = playlist[currentSong]
  audio.play()
}

//mute sound
const volumeControl = document.querySelector('.mute-icon')

volumeControl.addEventListener('click', soundMute)

const currentVolume = audio.volume
function soundMute () {
  if (audio.volume !== 0) {
    volumeControl.src = 'assets/svg/sound-icon.svg'
    audio.volume = 0.0
  } else {
    volumeControl.src = 'assets/svg/mute-icon.svg'
    audio.volume = currentVolume
  }
}